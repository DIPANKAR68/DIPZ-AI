<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0a0a0f">
<meta name="description" content="Dipz AI ‚Äî Free AI Chat. No sign-up needed. Built by Dipankar Mandal.">
<title>Dipz AI</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:#0a0a0f; --surface:#111118; --surface2:#1a1a24; --border:#252535;
    --accent:#7c6af7; --accent2:#f76a8a; --green:#5de8a0;
    --gpt:#10b981; --gpt2:#06d6a0;
    --text:#e8e8f0; --muted:#6b6b85;
  }
  *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
  html,body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);height:100%;width:100%;overflow:hidden;-webkit-font-smoothing:antialiased}
  .app{display:flex;width:100%;height:100dvh;position:relative;overflow:hidden}

  /* ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ */
  .sidebar{width:280px;background:var(--surface);border-right:1px solid var(--border);display:flex;flex-direction:column;flex-shrink:0;z-index:200;transition:transform .28s cubic-bezier(.4,0,.2,1);overflow:hidden}
  .sidebar-inner{display:flex;flex-direction:column;height:100%;padding:18px 14px 0;overflow:hidden}
  .logo{font-family:'Syne',sans-serif;font-weight:800;font-size:21px;margin-bottom:18px;padding:0 4px;display:flex;align-items:center;gap:10px;flex-shrink:0}
  .logo-icon{width:32px;height:32px;flex-shrink:0;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px}
  .logo span{background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
  .new-chat-btn{background:linear-gradient(135deg,var(--accent),#5a4ee0);color:white;border:none;border-radius:10px;padding:11px 16px;font-family:'DM Sans',sans-serif;font-size:14px;font-weight:500;cursor:pointer;display:flex;align-items:center;gap:8px;margin-bottom:14px;flex-shrink:0;min-height:44px;transition:opacity .2s}
  .new-chat-btn:active{opacity:.75}
  .section-label{font-size:10px;font-weight:700;letter-spacing:1.4px;text-transform:uppercase;color:var(--muted);padding:0 4px;margin-bottom:6px;flex-shrink:0}
  .history-list{flex:1;overflow-y:auto;min-height:0;-webkit-overflow-scrolling:touch}
  .history-list::-webkit-scrollbar{width:0}
  .history-item{padding:10px;border-radius:8px;font-size:13px;color:var(--muted);cursor:pointer;min-height:40px;display:flex;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:background .15s,color .15s}
  .history-item:active{background:var(--surface2);color:var(--text)}
  .sidebar-bottom{overflow-y:auto;flex-shrink:0;max-height:62vh;-webkit-overflow-scrolling:touch}
  .sidebar-bottom::-webkit-scrollbar{width:0}

  /* Tabs */
  .provider-tabs{display:flex;gap:6px;margin-top:10px;padding-bottom:12px;border-bottom:1px solid var(--border);flex-shrink:0}
  .ptab{flex:1;padding:8px 4px;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;transition:all .2s;min-height:38px}
  .ptab.gpt{background:rgba(16,185,129,.12);color:var(--gpt);border:1px solid rgba(16,185,129,.3)}
  .ptab.claude{background:rgba(124,106,247,.12);color:var(--accent);border:1px solid rgba(124,106,247,.25)}
  .ptab.active.gpt{background:rgba(16,185,129,.28);border-color:var(--gpt)}
  .ptab.active.claude{background:rgba(124,106,247,.28);border-color:var(--accent)}

  /* Panels */
  .api-panel{display:none;padding:12px 0 0}
  .api-panel.active{display:block}

  /* GPT Free box */
  .gpt-free-box{background:linear-gradient(135deg,rgba(16,185,129,.12),rgba(6,214,160,.07));border:1px solid rgba(16,185,129,.3);border-radius:12px;padding:14px}
  .gfb-badge{display:inline-flex;align-items:center;gap:5px;background:rgba(16,185,129,.2);border:1px solid rgba(16,185,129,.4);border-radius:20px;padding:3px 10px;font-size:11px;font-weight:700;color:var(--gpt);margin-bottom:10px;letter-spacing:.3px}
  .gfb-title{font-size:14px;font-weight:700;font-family:'Syne',sans-serif;color:var(--text);margin-bottom:5px}
  .gfb-model{font-family:'DM Mono',monospace;font-size:12px;color:var(--gpt2);background:rgba(6,214,160,.08);border:1px solid rgba(6,214,160,.2);border-radius:6px;padding:6px 10px;margin-bottom:10px;word-break:break-all;user-select:all}
  .gfb-desc{font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:10px}
  .gfb-copy{width:100%;padding:9px;background:rgba(16,185,129,.18);border:1px solid rgba(16,185,129,.35);border-radius:8px;color:var(--gpt);font-family:'DM Sans',sans-serif;font-size:12px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:5px;min-height:38px;transition:opacity .2s}
  .gfb-copy:active{opacity:.7}

  .model-picker{width:100%;background:var(--surface2);border:1px solid var(--border);color:var(--text);border-radius:8px;padding:9px 10px;font-family:'DM Sans',sans-serif;font-size:12px;outline:none;cursor:pointer;margin-top:10px;-webkit-appearance:none;min-height:40px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236b6b85' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 10px center;padding-right:30px}

  /* Claude panel */
  .api-input-wrap{position:relative}
  .api-input{width:100%;background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:10px 46px 10px 10px;color:var(--text);font-size:12px;font-family:'DM Mono',monospace;outline:none;transition:border-color .2s;-webkit-appearance:none;min-height:40px}
  .api-input:focus{border-color:var(--accent)}
  .api-input::placeholder{color:var(--muted)}
  .api-save-btn{position:absolute;right:6px;top:50%;transform:translateY(-50%);background:var(--accent);border:none;border-radius:5px;color:white;font-size:11px;padding:4px 8px;cursor:pointer;font-family:'DM Sans',sans-serif;font-weight:600;min-height:28px}
  .api-status{font-size:11px;margin-top:5px;color:var(--muted);min-height:15px}
  .api-status.ok{color:var(--green)}
  .get-key-banner{margin-top:10px;background:linear-gradient(135deg,rgba(124,106,247,.1),rgba(247,106,138,.06));border:1px solid rgba(124,106,247,.22);border-radius:10px;padding:11px 12px}
  .gkb-title{font-size:12px;font-weight:600;color:var(--text);margin-bottom:4px}
  .gkb-desc{font-size:11px;color:var(--muted);line-height:1.55;margin-bottom:8px}
  .gkb-btn{display:flex;align-items:center;justify-content:center;gap:5px;width:100%;padding:9px;border:none;border-radius:7px;color:white;font-family:'DM Sans',sans-serif;font-size:12px;font-weight:600;cursor:pointer;text-decoration:none;min-height:38px;background:linear-gradient(135deg,var(--accent),#5a4ee0)}

  /* Credits */
  .credits{padding:10px 0 16px;border-top:1px solid var(--border);margin-top:10px}
  .credits-card{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;background:var(--surface2)}
  .credits-av{width:36px;height:36px;border-radius:50%;flex-shrink:0;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-size:12px;font-weight:700;color:white}
  .credits-made{font-size:10px;color:var(--muted)}
  .credits-name{font-size:13px;font-weight:600;font-family:'Syne',sans-serif;color:var(--text)}
  .credits-link{font-size:11px;color:var(--accent);text-decoration:none;display:inline-flex;align-items:center;gap:3px;margin-top:2px}

  /* Overlay */
  .overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.65);z-index:199;opacity:0;transition:opacity .28s}
  .overlay.show{opacity:1}

  /* ‚îÄ‚îÄ Main ‚îÄ‚îÄ */
  .main{flex:1;display:flex;flex-direction:column;overflow:hidden;min-width:0}
  .topbar{display:flex;align-items:center;justify-content:space-between;padding:0 14px;height:54px;min-height:54px;border-bottom:1px solid var(--border);background:var(--surface);flex-shrink:0;gap:10px}
  .topbar-left{display:flex;align-items:center;gap:8px;min-width:0}
  .menu-btn{display:none;background:none;border:none;color:var(--text);cursor:pointer;padding:6px;border-radius:8px;align-items:center;justify-content:center;min-width:40px;min-height:40px;flex-shrink:0}
  .topbar-brand{font-family:'Syne',sans-serif;font-weight:800;font-size:17px;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;white-space:nowrap}
  .provider-badge{font-size:11px;font-weight:600;padding:3px 9px;border-radius:20px;white-space:nowrap;flex-shrink:0}
  .provider-badge.gpt{background:rgba(16,185,129,.18);color:var(--gpt);border:1px solid rgba(16,185,129,.35)}
  .provider-badge.claude{background:rgba(124,106,247,.18);color:var(--accent);border:1px solid rgba(124,106,247,.35)}
  .topbar-new{background:var(--surface2);border:1px solid var(--border);color:var(--text);border-radius:8px;padding:7px 12px;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:500;cursor:pointer;display:flex;align-items:center;gap:6px;min-height:36px;flex-shrink:0}
  .topbar-new:active{opacity:.75}

  /* Chat */
  .chat-area{flex:1;overflow-y:auto;overflow-x:hidden;padding:24px 0 12px;scroll-behavior:smooth;-webkit-overflow-scrolling:touch}
  .chat-area::-webkit-scrollbar{width:3px}
  .chat-area::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}

  /* Welcome */
  .welcome{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100%;gap:12px;text-align:center;padding:28px 20px;animation:fadeUp .45s ease}
  .welcome-icon{width:68px;height:68px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:18px;display:flex;align-items:center;justify-content:center;font-size:32px;margin-bottom:4px;box-shadow:0 0 36px rgba(124,106,247,.35)}
  .welcome h1{font-family:'Syne',sans-serif;font-size:28px;font-weight:800;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
  .welcome p{color:var(--muted);font-size:14px;max-width:360px;line-height:1.65}
  .welcome-by{font-size:12px;color:var(--muted)}
  .welcome-by a{color:var(--accent);text-decoration:none;font-weight:500}

  .ready-box{max-width:400px;width:100%;background:linear-gradient(135deg,rgba(16,185,129,.1),rgba(6,214,160,.06));border:1px solid rgba(16,185,129,.3);border-radius:14px;padding:16px;text-align:left}
  .rb-top{display:flex;align-items:center;gap:8px;margin-bottom:8px}
  .rb-dot{width:10px;height:10px;background:var(--gpt);border-radius:50%;box-shadow:0 0 8px var(--gpt);animation:pulse 2s infinite}
  @keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
  .rb-title{font-size:14px;font-weight:700;color:var(--text);font-family:'Syne',sans-serif}
  .rb-model{font-family:'DM Mono',monospace;font-size:11px;color:var(--gpt2);background:rgba(6,214,160,.08);border:1px solid rgba(6,214,160,.2);border-radius:6px;padding:5px 8px;margin-bottom:8px;word-break:break-all}
  .rb-desc{font-size:12px;color:var(--muted);line-height:1.6}

  .no-key-notice{display:none;max-width:380px;width:100%;background:rgba(247,106,138,.08);border:1px solid rgba(247,106,138,.3);border-radius:12px;padding:13px 16px;text-align:left}
  .no-key-notice.show{display:block}
  .nkn-title{font-size:13px;font-weight:600;color:var(--accent2);margin-bottom:4px}
  .nkn-body{font-size:13px;color:var(--muted);line-height:1.6}
  .nkn-body a{color:var(--accent);text-decoration:none;font-weight:500}

  .suggestions{display:grid;grid-template-columns:1fr 1fr;gap:9px;margin-top:8px;max-width:500px;width:100%}
  .suggestion-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 14px;cursor:pointer;text-align:left;font-size:13px;color:var(--muted);line-height:1.5;transition:border-color .2s}
  .suggestion-card:active{border-color:var(--accent);background:var(--surface2);color:var(--text)}
  .suggestion-card strong{display:block;font-size:13px;color:var(--text);margin-bottom:2px;font-weight:600}

  /* Messages */
  .message-group{max-width:720px;margin:0 auto;padding:0 16px;animation:fadeUp .3s ease}
  .message{display:flex;gap:12px;padding:16px 0;border-bottom:1px solid rgba(255,255,255,.04)}
  .avatar{width:32px;height:32px;border-radius:9px;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:15px;margin-top:2px}
  .avatar.user{background:linear-gradient(135deg,#3a3a5c,#252540)}
  .avatar.gpt-ai{background:linear-gradient(135deg,var(--gpt),#059669)}
  .avatar.claude-ai{background:linear-gradient(135deg,var(--accent),var(--accent2))}
  .msg-content{flex:1;min-width:0}
  .msg-role{font-size:11px;font-weight:700;letter-spacing:.6px;color:var(--muted);margin-bottom:5px;text-transform:uppercase}
  .msg-text{color:var(--text);font-size:15px;line-height:1.75;word-break:break-word;overflow-wrap:anywhere}
  .msg-text p{margin-bottom:10px}
  .msg-text p:last-child{margin-bottom:0}
  .msg-text code{background:var(--surface2);border:1px solid var(--border);border-radius:5px;padding:2px 6px;font-family:'DM Mono',monospace;font-size:13px;color:#b4a7ff}
  .msg-text pre{background:var(--surface2);border:1px solid var(--border);border-radius:10px;padding:14px;margin:10px 0;overflow-x:auto;-webkit-overflow-scrolling:touch}
  .msg-text pre code{background:none;border:none;padding:0;color:#c8c0ff}
  .msg-text ul,.msg-text ol{padding-left:20px;margin-bottom:10px}
  .msg-text li{margin-bottom:4px}
  .msg-text strong{color:#d0c8ff}
  .msg-text h1,.msg-text h2,.msg-text h3{font-family:'Syne',sans-serif;color:var(--text);margin:14px 0 6px}

  /* Typing */
  .typing{display:flex;gap:5px;align-items:center;padding:8px 0}
  .typing span{width:7px;height:7px;border-radius:50%;animation:bounce 1.2s infinite}
  .typing.gpt-t span{background:var(--gpt)}
  .typing.claude-t span{background:var(--accent)}
  .typing span:nth-child(2){animation-delay:.2s}
  .typing span:nth-child(3){animation-delay:.4s}
  @keyframes bounce{0%,80%,100%{transform:scale(.6);opacity:.4}40%{transform:scale(1);opacity:1}}

  /* Input */
  .input-area{padding:10px 16px;padding-bottom:calc(12px + env(safe-area-inset-bottom,0px));background:var(--bg);flex-shrink:0;border-top:1px solid var(--border)}
  .input-wrap{max-width:720px;margin:0 auto;position:relative;background:var(--surface);border:1px solid var(--border);border-radius:14px;transition:border-color .2s,box-shadow .2s}
  .input-wrap:focus-within{border-color:var(--accent);box-shadow:0 0 0 3px rgba(124,106,247,.12)}
  #messageInput{width:100%;background:transparent;border:none;outline:none;padding:13px 54px 13px 16px;color:var(--text);font-family:'DM Sans',sans-serif;font-size:16px;resize:none;max-height:160px;line-height:1.5;-webkit-appearance:none}
  #messageInput::placeholder{color:var(--muted)}
  .send-btn{position:absolute;right:9px;bottom:8px;width:38px;height:38px;background:linear-gradient(135deg,var(--accent),#5a4ee0);border:none;border-radius:9px;color:white;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:opacity .2s}
  .send-btn:active{opacity:.7}
  .send-btn:disabled{opacity:.35;cursor:not-allowed}
  .input-footer{max-width:720px;margin:7px auto 0;font-size:11px;color:var(--muted);text-align:center}
  .input-footer a{color:var(--accent);text-decoration:none}

  @keyframes fadeUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

  .toast{position:fixed;bottom:calc(80px + env(safe-area-inset-bottom,0px));left:50%;transform:translateX(-50%);padding:10px 18px;border-radius:10px;font-size:13px;z-index:999;animation:fadeUp .3s ease;max-width:calc(100vw - 32px);text-align:center;box-shadow:0 4px 20px rgba(0,0,0,.4)}
  .toast.err{background:#3a1a22;border:1px solid var(--accent2);color:var(--accent2)}
  .toast.ok{background:#0f2a1e;border:1px solid var(--green);color:var(--green)}

  @media(max-width:700px){
    .sidebar{position:fixed;top:0;left:0;bottom:0;transform:translateX(-100%);box-shadow:4px 0 24px rgba(0,0,0,.5)}
    .sidebar.open{transform:translateX(0)}
    .overlay{display:block}
    .menu-btn{display:flex}
    .suggestions{grid-template-columns:1fr;max-width:100%}
    .msg-text{font-size:14px}
  }
  @media(max-width:400px){
    .welcome h1{font-size:24px}
    .welcome-icon{width:56px;height:56px;font-size:26px}
    .topbar-brand{font-size:15px}
  }
</style>
</head>
<body>
<div class="app">
<div class="overlay" id="overlay" onclick="closeSidebar()"></div>

<!-- ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-inner">
    <div class="logo">
      <div class="logo-icon">‚ö°</div>
      <span>Dipz AI</span>
    </div>
    <button class="new-chat-btn" onclick="newChat()">
      <svg width="15" height="15" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg>
      New Chat
    </button>
    <div class="section-label">Recent Chats</div>
    <div class="history-list" id="historyList"></div>

    <div class="sidebar-bottom">
      <!-- Tabs -->
      <div class="provider-tabs">
        <button class="ptab gpt active" id="tabGPT" onclick="switchProvider('gpt')">ü§ñ Free GPT</button>
        <button class="ptab claude" id="tabClaude" onclick="switchProvider('claude')">‚ö° Claude</button>
      </div>

      <!-- GPT Free Panel -->
      <div class="api-panel active" id="panelGPT">
        <div class="gpt-free-box">
          <div class="gfb-badge">
            <span style="width:7px;height:7px;background:var(--gpt);border-radius:50%;box-shadow:0 0 6px var(--gpt);animation:pulse 2s infinite;display:inline-block"></span>
            100% FREE ¬∑ NO KEY NEEDED
          </div>
          <div class="gfb-title">GPT OSS 20B</div>
          <div class="gfb-model">openai/gpt-oss-20b:free</div>
          <div class="gfb-desc">This model is completely free via OpenRouter. No API key, no sign-up, no billing ‚Äî just open and chat!</div>
          <button class="gfb-copy" onclick="copyModel()">
            <svg width="12" height="12" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
            Copy Model ID
          </button>
        </div>

        <div class="section-label" style="margin-top:12px">Other Free Models</div>
        <select class="model-picker" id="gptModel">
          <option value="openai/gpt-oss-20b:free">GPT OSS 20B ‚ö° (Default)</option>
          <option value="deepseek/deepseek-r1-0528:free">DeepSeek R1 üß† Free</option>
          <option value="meta-llama/llama-3.1-8b-instruct:free">Llama 3.1 8B Free</option>
          <option value="mistralai/mistral-7b-instruct:free">Mistral 7B Free</option>
          <option value="google/gemma-3-27b-it:free">Gemma 3 27B Free</option>
          <option value="qwen/qwen3-235b-a22b:free">Qwen3 235B Free</option>
        </select>

        <div style="margin-top:9px;font-size:11px;color:var(--muted);line-height:1.55;padding:0 2px">
          Powered by <a href="https://openrouter.ai" target="_blank" style="color:var(--gpt);text-decoration:none">OpenRouter.ai</a> free tier. All models above have <strong style="color:var(--text)">:free</strong> suffix ‚Äî zero cost.
        </div>
      </div>

      <!-- Claude Panel -->
      <div class="api-panel" id="panelClaude">
        <div class="section-label">Anthropic API Key</div>
        <div class="api-input-wrap">
          <input type="password" class="api-input" id="claudeKeyInput" placeholder="sk-ant-api03-..." />
          <button class="api-save-btn" onclick="saveClaudeKey()">Save</button>
        </div>
        <div class="api-status" id="claudeStatus">No key saved</div>
        <select class="model-picker" id="claudeModel">
          <option value="claude-sonnet-4-6">Claude Sonnet 4.6 ‚ö°</option>
          <option value="claude-opus-4-6">Claude Opus 4.6 üß†</option>
          <option value="claude-haiku-4-5-20251001">Claude Haiku 4.5 üöÄ</option>
        </select>
        <div class="get-key-banner">
          <div class="gkb-title">üîë Get a free Claude key</div>
          <div class="gkb-desc">Free credits for new accounts. Takes 1 minute.</div>
          <a href="https://console.anthropic.com/settings/keys" target="_blank" class="gkb-btn">Get Claude Key ‚Üó</a>
        </div>
      </div>

      <!-- Credits -->
      <div class="credits">
        <div class="credits-card">
          <div class="credits-av">DM</div>
          <div>
            <div class="credits-made">Made with ‚ù§Ô∏è by</div>
            <div class="credits-name">Dipankar Mandal</div>
            <a href="https://dipankar68.github.io/portfolio/" target="_blank" class="credits-link">
              <svg width="11" height="11" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6M15 3h6v6M10 14L21 3"/></svg>
              Portfolio ‚Üó
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</aside>

<!-- ‚îÄ‚îÄ Main ‚îÄ‚îÄ -->
<main class="main">
  <div class="topbar">
    <div class="topbar-left">
      <button class="menu-btn" id="menuBtn" onclick="openSidebar()">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 12h18M3 6h18M3 18h18"/></svg>
      </button>
      <div class="topbar-brand">Dipz AI</div>
      <div class="provider-badge gpt" id="providerBadge">ü§ñ GPT OSS 20B</div>
    </div>
    <button class="topbar-new" onclick="newChat()">
      <svg width="13" height="13" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg>
      New
    </button>
  </div>

  <div class="chat-area" id="chatArea">
    <div class="welcome" id="welcome">
      <div class="welcome-icon">‚ö°</div>
      <h1>Dipz AI</h1>
      <p>Free AI chat ‚Äî no sign-up, no API key needed. Powered by GPT OSS 20B.</p>
      <div class="welcome-by">Built by <a href="https://dipankar68.github.io/portfolio/" target="_blank">Dipankar Mandal</a></div>

      <!-- GPT Ready -->
      <div class="ready-box" id="readyBox">
        <div class="rb-top">
          <div class="rb-dot"></div>
          <div class="rb-title">Ready to chat ‚Äî no key needed!</div>
        </div>
        <div class="rb-model">openai/gpt-oss-20b:free</div>
        <div class="rb-desc">GPT OSS 20B is running free via OpenRouter. Just type your message below and hit send!</div>
      </div>

      <!-- Claude no key -->
      <div class="no-key-notice" id="noKeyNotice">
        <div class="nkn-title">‚ö†Ô∏è Claude API Key Required</div>
        <div class="nkn-body">
          Add your Claude API key in the sidebar, or switch to <strong>Free GPT</strong> ‚Äî works with zero setup!<br><br>
          <a href="https://console.anthropic.com/settings/keys" target="_blank">Get a free Claude key ‚Üí</a>
        </div>
      </div>

      <div class="suggestions">
        <div class="suggestion-card" onclick="suggest('Explain quantum computing in simple terms')">
          <strong>üî¨ Science</strong>Explain quantum computing simply
        </div>
        <div class="suggestion-card" onclick="suggest('Write a Python function to build a REST API')">
          <strong>üíª Code</strong>Write a Python REST API
        </div>
        <div class="suggestion-card" onclick="suggest('Help me write a professional LinkedIn bio')">
          <strong>‚úçÔ∏è Writing</strong>Write me a LinkedIn bio
        </div>
        <div class="suggestion-card" onclick="suggest('Give me 10 creative startup ideas for 2025')">
          <strong>üí° Ideas</strong>10 creative startup ideas for 2025
        </div>
      </div>
    </div>
    <div id="messages"></div>
  </div>

  <div class="input-area">
    <div class="input-wrap">
      <textarea id="messageInput" placeholder="Message Dipz AI‚Ä¶" rows="1"
        onkeydown="handleKey(event)" oninput="autoResize(this)"></textarea>
      <button class="send-btn" id="sendBtn" onclick="sendMessage()">
        <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></svg>
      </button>
    </div>
    <div class="input-footer">
      Dipz AI ¬∑ <a href="https://dipankar68.github.io/portfolio/" target="_blank">Dipankar Mandal</a> ¬∑ Free GPT &amp; Claude
    </div>
  </div>
</main>
</div>

<script>
  let provider = 'gpt';
  let conversations = [];
  let currentConvo = [];
  let isLoading = false;
  let claudeKey = localStorage.getItem('dipz_claude_key') || '';

  (function init() {
    if (claudeKey) {
      document.getElementById('claudeKeyInput').value = claudeKey;
      document.getElementById('claudeStatus').textContent = '‚úì Claude key saved & ready';
      document.getElementById('claudeStatus').className = 'api-status ok';
    }
    updateNotices();
    const setVH = () => document.documentElement.style.setProperty('--vh', window.innerHeight * 0.01 + 'px');
    setVH(); window.addEventListener('resize', setVH);
  })();

  function openSidebar() {
    document.getElementById('sidebar').classList.add('open');
    const ov = document.getElementById('overlay');
    ov.style.display = 'block';
    requestAnimationFrame(() => ov.classList.add('show'));
  }
  function closeSidebar() {
    document.getElementById('sidebar').classList.remove('open');
    const ov = document.getElementById('overlay');
    ov.classList.remove('show');
    setTimeout(() => { ov.style.display = 'none'; }, 280);
  }

  function switchProvider(p) {
    provider = p;
    document.getElementById('tabGPT').classList.toggle('active', p === 'gpt');
    document.getElementById('tabClaude').classList.toggle('active', p === 'claude');
    document.getElementById('panelGPT').classList.toggle('active', p === 'gpt');
    document.getElementById('panelClaude').classList.toggle('active', p === 'claude');
    const badge = document.getElementById('providerBadge');
    badge.className = 'provider-badge ' + p;
    badge.textContent = p === 'gpt' ? 'ü§ñ GPT OSS 20B' : '‚ö° Claude';
    updateNotices();
  }

  function updateNotices() {
    document.getElementById('readyBox').style.display = provider === 'gpt' ? 'block' : 'none';
    document.getElementById('noKeyNotice').classList.toggle('show', provider === 'claude' && !claudeKey);
  }

  function saveClaudeKey() {
    const k = document.getElementById('claudeKeyInput').value.trim();
    if (!k) { showToast('Please enter your Claude API key', 'err'); return; }
    claudeKey = k;
    localStorage.setItem('dipz_claude_key', k);
    document.getElementById('claudeStatus').textContent = '‚úì Claude key saved & ready';
    document.getElementById('claudeStatus').className = 'api-status ok';
    updateNotices();
    showToast('‚úì Claude key saved!', 'ok');
    closeSidebar();
  }

  function copyModel() {
    navigator.clipboard.writeText('openai/gpt-oss-20b:free').then(() => {
      showToast('‚úì Model ID copied!', 'ok');
    }).catch(() => {
      showToast('Model: openai/gpt-oss-20b:free', 'ok');
    });
  }

  function autoResize(el) {
    el.style.height = 'auto';
    el.style.height = Math.min(el.scrollHeight, 160) + 'px';
  }
  function handleKey(e) {
    if (e.key === 'Enter' && !e.shiftKey && !(/Android|iPhone|iPad/i.test(navigator.userAgent))) {
      e.preventDefault(); sendMessage();
    }
  }

  function newChat() {
    if (currentConvo.length > 0) {
      const preview = currentConvo[0]?.content?.slice(0, 46) || 'Chat';
      conversations.unshift({ preview, messages: [...currentConvo], provider });
      renderHistory();
    }
    currentConvo = [];
    document.getElementById('messages').innerHTML = '';
    document.getElementById('welcome').style.display = 'flex';
    closeSidebar();
  }

  function renderHistory() {
    document.getElementById('historyList').innerHTML = conversations.slice(0, 20)
      .map((c, i) => `<div class="history-item" onclick="loadConvo(${i})">${c.preview}‚Ä¶</div>`).join('');
  }

  function loadConvo(i) {
    const c = conversations[i];
    currentConvo = [...c.messages];
    if (c.provider) switchProvider(c.provider);
    document.getElementById('welcome').style.display = 'none';
    document.getElementById('messages').innerHTML = '';
    currentConvo.forEach(m => appendMessage(m.role, m.content, false, m.providerUsed));
    closeSidebar();
  }

  function suggest(t) {
    if (provider === 'claude' && !claudeKey) {
      showToast('Add Claude key or switch to Free GPT!', 'err');
      openSidebar(); return;
    }
    document.getElementById('messageInput').value = t;
    autoResize(document.getElementById('messageInput'));
    sendMessage();
  }

  async function sendMessage() {
    if (isLoading) return;
    const input = document.getElementById('messageInput');
    const text = input.value.trim();
    if (!text) return;

    if (provider === 'claude' && !claudeKey) {
      showToast('‚ö†Ô∏è Add your Claude API key first!', 'err');
      openSidebar(); return;
    }

    document.getElementById('welcome').style.display = 'none';
    input.value = ''; input.style.height = 'auto';

    appendMessage('user', text, true, 'user');
    currentConvo.push({ role: 'user', content: text });

    isLoading = true;
    document.getElementById('sendBtn').disabled = true;
    const typingEl = showTyping();

    try {
      let reply;
      if (provider === 'gpt') {
        reply = await callOpenRouter();
      } else {
        reply = await callClaude();
      }
      typingEl.remove();
      currentConvo.push({ role: 'assistant', content: reply, providerUsed: provider });
      appendMessage('assistant', reply, true, provider);
    } catch (err) {
      typingEl.remove();
      showToast('Error: ' + err.message, 'err');
      currentConvo.pop();
    }

    isLoading = false;
    document.getElementById('sendBtn').disabled = false;
  }

  async function callOpenRouter() {
    const model = document.getElementById('gptModel').value;
    const res = await fetch('https://openrouter.ai/api/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'HTTP-Referer': 'https://dipankar68.github.io/portfolio/',
        'X-Title': 'Dipz AI'
        // No Authorization header ‚Äî free models work without a key
      },
      body: JSON.stringify({
        model,
        messages: currentConvo.map(m => ({ role: m.role, content: m.content })),
        max_tokens: 2048
      })
    });
    if (!res.ok) {
      const e = await res.json().catch(() => ({}));
      const m = e.error?.message || `HTTP ${res.status}`;
      if (res.status === 429) throw new Error('Rate limit ‚Äî wait a moment and retry.');
      if (res.status === 402) throw new Error('This model needs credits ‚Äî switch to a :free model.');
      if (res.status === 401) throw new Error('Auth error ‚Äî try a different free model.');
      throw new Error(m.slice(0, 120));
    }
    const d = await res.json();
    const reply = d.choices?.[0]?.message?.content;
    if (!reply) throw new Error('Empty response ‚Äî try a different model.');
    return reply;
  }

  async function callClaude() {
    const model = document.getElementById('claudeModel').value;
    const res = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-api-key': claudeKey,
        'anthropic-version': '2023-06-01',
        'anthropic-dangerous-direct-browser-access': 'true'
      },
      body: JSON.stringify({ model, max_tokens: 2048, messages: currentConvo })
    });
    if (!res.ok) {
      const e = await res.json().catch(() => ({}));
      const m = e.error?.message || `HTTP ${res.status}`;
      if (res.status === 401) throw new Error('Invalid Claude key.');
      if (res.status === 429) throw new Error('Rate limit ‚Äî please wait.');
      if (m.toLowerCase().includes('credit')) throw new Error('No credits ‚Äî add billing at console.anthropic.com');
      throw new Error(m.slice(0, 120));
    }
    const d = await res.json();
    return d.content[0].text;
  }

  function appendMessage(role, content, animate = true, prov) {
    const wrap = document.getElementById('messages');
    const div = document.createElement('div');
    div.className = 'message-group';
    if (!animate) div.style.animation = 'none';
    const isUser = role === 'user';
    const isGPT = !isUser && prov === 'gpt';
    const modelEl = document.getElementById('gptModel');
    const modelLabel = isGPT ? modelEl.options[modelEl.selectedIndex].text.split('(')[0].trim() : 'Claude';
    div.innerHTML = `
      <div class="message">
        <div class="avatar ${isUser ? 'user' : isGPT ? 'gpt-ai' : 'claude-ai'}">${isUser ? 'üë§' : isGPT ? 'ü§ñ' : '‚ö°'}</div>
        <div class="msg-content">
          <div class="msg-role">${isUser ? 'You' : modelLabel}</div>
          <div class="msg-text">${fmt(content)}</div>
        </div>
      </div>`;
    wrap.appendChild(div);
    setTimeout(() => div.scrollIntoView({ behavior: 'smooth', block: 'end' }), 60);
  }

  function showTyping() {
    const wrap = document.getElementById('messages');
    const div = document.createElement('div');
    div.className = 'message-group';
    const isGPT = provider === 'gpt';
    div.innerHTML = `
      <div class="message">
        <div class="avatar ${isGPT ? 'gpt-ai' : 'claude-ai'}">${isGPT ? 'ü§ñ' : '‚ö°'}</div>
        <div class="msg-content">
          <div class="msg-role">${isGPT ? 'GPT OSS 20B' : 'Claude'}</div>
          <div class="typing ${isGPT ? 'gpt-t' : 'claude-t'}"><span></span><span></span><span></span></div>
        </div>
      </div>`;
    wrap.appendChild(div);
    setTimeout(() => div.scrollIntoView({ behavior: 'smooth', block: 'end' }), 60);
    return div;
  }

  function fmt(t) {
    t = t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
    t = t.replace(/```(\w*)\n?([\s\S]*?)```/g,'<pre><code>$2</code></pre>');
    t = t.replace(/`([^`\n]+)`/g,'<code>$1</code>');
    t = t.replace(/\*\*\*(.+?)\*\*\*/g,'<strong><em>$1</em></strong>');
    t = t.replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>');
    t = t.replace(/\*(.+?)\*/g,'<em>$1</em>');
    t = t.replace(/^### (.+)$/gm,'<h3>$1</h3>');
    t = t.replace(/^## (.+)$/gm,'<h2>$1</h2>');
    t = t.replace(/^# (.+)$/gm,'<h1>$1</h1>');
    t = t.replace(/^[‚Ä¢\-\*] (.+)$/gm,'<li>$1</li>');
    t = t.replace(/(<li>.*?<\/li>(\n|$))+/g,m=>'<ul>'+m+'</ul>');
    return t.split(/\n\n+/).map(b=>{
      b=b.trim(); if(!b) return '';
      if(/^<(pre|ul|ol|h[123])/.test(b)) return b;
      return '<p>'+b.replace(/\n/g,'<br>')+'</p>';
    }).filter(Boolean).join('');
  }

  function showToast(msg, type='ok') {
    document.querySelector('.toast')?.remove();
    const t = document.createElement('div');
    t.className = 'toast '+type; t.textContent = msg;
    document.body.appendChild(t);
    setTimeout(()=>t?.remove(), 4500);
  }
</script>
</body>
</html>
